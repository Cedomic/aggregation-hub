version: "3.3"

networks:
  host:
    external:
      name: host

services:
  store:
    build:
      context: .
      args:
        PORT: ${PORT}
    container_name: store
    environment:
      - DB_SERVER=http://elasticsearch_1:9200
      - PORT=3003
      - WAIT_HOSTS=elasticsearch_1:9200
    restart: always
    volumes:
      - ./logs:/home/dockeruser/app/logs/
    ports:
      - "3003:3003"
    networks:
      - host
  elasticsearch_1:
    image: docker.elastic.co/elasticsearch/elasticsearch-oss:7.4.0
    container_name: elasticsearch_1
    restart: always
    environment:
      - discovery.type=single-node
    volumes:
      - ./elasticsearch-data-test:/usr/share/elasticsearch/data
    ports:
      - "9200:9200"
    networks:
      - host
